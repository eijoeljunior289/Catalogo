// === BANCO DE DADOS DE JOGOS E APPS ===
window.games = [
    // ðŸ•¹ï¸ JOGOS
    {
        id: 1,
        title: 'Fuga de Marte',
        category: 'jogos',
        image: 'logos/fm.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.JEGIF.FugaDeMarteIntroduoAAlgoritmos&pcampaignid=web_share'
    },
    {
        id: 2,
        title: 'Jararavras',
        category: 'jogos',
        image: 'logos/j.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },
    {
        id: 3,
        title: 'Script Saga',
        category: 'jogos',
        image: 'logos/ss.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.SCRIPTSAGA&pcampaignid=web_share'
    },
    {
        id: 4,
        title: 'Tabuleiro LÃ³gico',
        category: 'jogos',
        image: 'logos/tl.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.TabuleiroLogico&pcampaignid=web_share'
    },
    {
        id: 5,
        title: 'InterageTEA',
        category: 'jogos',
        image: 'logos/it.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBaiano.InterageTEA&pcampaignid=web_share'
    },
    {
        id: 6,
        title: 'PeÃ§a por PeÃ§a',
        category: 'jogos',
        image: 'logos/pp.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.PECAPORPECA&pcampaignid=web_share'
    },
    {
        id: 7,
        title: 'MathAttack',
        category: 'jogos',
        image: 'logos/ma.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },
    {
        id: 8,
        title: "Dalton's Game",
        category: 'jogos',
        image: 'logos/dg.jpg',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.Shooter.DaltonsGame&pcampaignid=web_share'
    },
    {
        id: 9,
        title: 'Milenyum Math Navigator',
        category: 'jogos',
        image: 'logos/mmn.png',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.MilenyumMathNavigator&pcampaignid=web_share'
    },
    {
        id: 10,
        title: 'Geometric Shapes In Space',
        category: 'jogos',
        image: 'logos/gss.png',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.GeometricShapesInSpace&pcampaignid=web_share'
    },
    {
        id: 11,
        title: 'Neon - Jogo de Soma',
        category: 'jogos',
        image: 'logos/njs.jpg',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFbaiamo.NeonJogodesoma&pcampaignid=web_share'
    },
    {
        id: 12,
        title: 'NÃºmeros nas Estrelas',
        category: 'jogos',
        image: 'logos/ne.png',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.NUMEROSNASESTRELAS&pcampaignid=web_share'
    },
    {
        id: 13,
        title: 'GamaMath',
        category: 'jogos',
        image: 'logos/gm.png',
        androidVersion: '8.1 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },
    {
        id: 14,
        title: 'Elementos GeomÃ©tricos',
        category: 'jogos',
        image: 'logos/eg.png',
        androidVersion: '8.1 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.ElementosGeometricosria&pcampaignid=web_share'
    },
    {
        id: 15,
        title: 'Oxe e as Vogais',
        category: 'jogos',
        image: 'logos/ov.jpg',
        androidVersion: '8.1 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.OXE&pcampaignid=web_share'
    },
    {
        id: 16,
        title: 'Charadas da MatemÃ¡tica',
        category: 'jogos',
        image: 'logos/cm.webp',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },

    // ðŸ“± APPS
    {
        id: 17,
        title: 'EditQuiz',
        category: 'apps',
        image: 'logos/eq.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.DefaultCompany.EditQuiz&pcampaignid=web_share'
    },
    {
        id: 18,
        title: 'CÃ³digo de Defesa do Consumidor',
        category: 'apps',
        image: 'logos/cdc.webp',
        androidVersion: '15 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IfbaianoAppDev.CdigodeDefesadoConsumidor&pcampaignid=web_share'
    },
    {
        id: 19,
        title: 'InformÃ¡tica para Concursos',
        category: 'apps',
        image: 'logos/ic.webp',
        androidVersion: '9 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },
    {
        id: 20,
        title: 'TÃ©cnico AgrÃ­cola IFBAIANO',
        category: 'apps',
        image: 'logos/ta.webp',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.tec_agropecuaria&pcampaignid=web_share'
    },
    {
        id: 21,
        title: 'Tec. Agrimensura IFBAIANO',
        category: 'apps',
        image: 'logos/ag.webp',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.Biozard.CursoTecnicoemAgrimensura&pcampaignid=web_share'
    },
    {
        id: 22,
        title: 'Campus IFBAIANO',
        category: 'apps',
        image: 'logos/if.webp',
        androidVersion: '11 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },
    {
        id: 23,
        title: 'Brasil: UF e Bandeiras',
        category: 'apps',
        image: 'logos/br.webp',
        androidVersion: '8.1 ou superior',
        link: 'https://play.google.com/store/apps/developer?id=GRUPO+DE+ESTUDO+DE+JOGOS+DO+IFBAIANO'
    },
    {
        id: 24,
        title: 'TÃ©cnico InformÃ¡tica IFBAIANO',
        category: 'apps',
        image: 'logos/ti.webp',
        androidVersion: '8.1 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBaiano.Tecnoinf&pcampaignid=web_share'
    },
    {
        id: 25,
        title: 'Cursos do IFBAIANO',
        category: 'apps',
        image: 'logos/cif.webp',
        androidVersion: '13 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.CURSOS&pcampaignid=web_share'
    },
    {
        id: 26,
        title: 'Comunidades Quilombolas',
        category: 'apps',
        image: 'logos/cqb.webp',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANOAPPDEV.QuilombolasComunity&pcampaignid=web_share'
    },
    {
        id: 27,
        title: 'IntroduÃ§Ã£o Ã  ComputaÃ§Ã£o',
        category: 'apps',
        image: 'logos/icc.webp',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANO.IntroduoaComputao&pcampaignid=web_share'
    },
    {
        id: 28,
        title: 'TÃ©cnico Alimentos IFBAIANO',
        category: 'apps',
        image: 'logos/tal.webp',
        androidVersion: '14 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.YFCompany.TecnicoemAlimentos&pcampaignid=web_share'
    },
    {
        id: 29,
        title: 'Lic. em ComputaÃ§Ã£o IFBAIANO',
        category: 'apps',
        image: 'logos/lic.webp',
        androidVersion: '13 ou superior',
        link: 'https://play.google.com/store/apps/details?id=com.IFBAIANOSBF2022.appLcc2022&pcampaignid=web_share'
    }
];

// === ELEMENTOS DO DOM ===
const gamesGrid = document.querySelector('.games-grid');
const filterButtons = document.querySelectorAll('.filter-btn');
const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
const menu = document.querySelector('.menu');

// === INICIALIZAÃ‡ÃƒO ===
document.addEventListener('DOMContentLoaded', () => {
    // Inicializa Ã­cones do Lucide se existir
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
    
    // Exibe todos os jogos inicialmente usando a funÃ§Ã£o CORRETA
    renderGames('all');
    
    // Configura o menu mÃ³vel
    setupMobileMenu();
    
    // Inicia a neve (versÃ£o natalina)
    startSnow();
});

// === FUNÃ‡Ã•ES PRINCIPAIS ===

// 1. Renderizar Jogos (Com estrutura HTML Nova)
function renderGames(filter) {
    gamesGrid.innerHTML = '';
    
    const filtered = filter === 'all' 
        ? window.games 
        : window.games.filter(g => g.category === filter);
        
    // Efeito Fade-In suave
    gamesGrid.style.opacity = '0';
    gamesGrid.style.transition = 'opacity 0.3s ease';
    
    setTimeout(() => gamesGrid.style.opacity = '1', 50);

    filtered.forEach(game => {
        // Limpeza de tÃ­tulo e dados
        const cleanTitle = game.title.replace(/<[^>]*>?/gm, '');
        const image = game.image || '/placeholder.svg';
        const categoryLabel = game.category === 'jogos' ? 'ðŸŽ® Jogo' : 'ðŸ“± App';
        
        const card = document.createElement('div');
        card.className = 'game-card';
        
        // Estrutura HTML compatÃ­vel com o CSS de Natal (zoom, floating tag, etc)
        card.innerHTML = `
            <div class="card-image-box">
                <span class="card-tag-floating">${categoryLabel}</span>
                <img src="${image}" alt="${cleanTitle}" class="card-thumb" loading="lazy">
            </div>
            
            <div class="card-body">
                <h3 class="card-title">${cleanTitle}</h3>
                <p class="card-desc" style="font-size: 0.85rem; color: #888;">
                    VersÃ£o: Android ${game.androidVersion}+
                </p>
                
                <div class="card-footer">
                    <a href="${game.link}" target="_blank" class="install-btn">
                        <span>Baixar Agora</span>
                        <i data-lucide="gift" width="18"></i>
                    </a>
                </div>
            </div>
        `;
        gamesGrid.appendChild(card);
    });
    
    // Atualiza os Ã­cones do Lucide nos novos elementos
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}

// 2. Filtros
filterButtons.forEach(button => {
    button.addEventListener('click', () => {
        // Atualiza botÃµes ativos
        filterButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        
        // Filtra usando a funÃ§Ã£o renderGames
        const category = button.getAttribute('data-filter');
        renderGames(category);
    });
});

// 3. Menu Mobile
function setupMobileMenu() {
    if (!mobileMenuBtn) return;
    
    mobileMenuBtn.addEventListener('click', () => {
        menu.classList.toggle('active');
        
        // AnimaÃ§Ã£o do Ã­cone de hambÃºrguer
        const spans = mobileMenuBtn.querySelectorAll('span');
        if (menu.classList.contains('active')) {
            // Se tiver classes de rotaÃ§Ã£o no CSS, pode usar classList, senÃ£o manipula style
            // Aqui mantemos consistÃªncia com o estilo anterior
            if(spans.length >= 3) {
                spans[0].style.transform = 'rotate(45deg) translate(5px, 5px)';
                spans[1].style.opacity = '0';
                spans[2].style.transform = 'rotate(-45deg) translate(5px, -5px)';
            }
        } else {
            if(spans.length >= 3) {
                spans[0].style.transform = 'none';
                spans[1].style.opacity = '1';
                spans[2].style.transform = 'none';
            }
        }
    });
}

// 4. BotÃ£o "Ver Todos" (Rolagem suave e filtro)
const viewAllButton = document.getElementById('view-all-games');
if (viewAllButton) {
    viewAllButton.addEventListener('click', (event) => {
        event.preventDefault();
        
        // Clica virtualmente no botÃ£o "Todos"
        const allBtn = document.querySelector('[data-filter="all"]');
        if(allBtn) allBtn.click();
        
        // Rolagem suave
        const target = document.querySelector('#games');
        if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
        }
    });
}

// 5. Scroll Suave Geral para Links Internos
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function(e) {
        // Se for sÃ³ #, nÃ£o faz nada
        if(this.getAttribute('href') === '#') return;

        e.preventDefault();
        const targetId = this.getAttribute('href');
        const targetElement = document.querySelector(targetId);
        
        if (targetElement) {
            // Fecha menu mobile se estiver aberto
            menu.classList.remove('active');
            
            // Reseta Ã­cone menu
            const spans = mobileMenuBtn ? mobileMenuBtn.querySelectorAll('span') : [];
            if(spans.length >= 3) {
                spans[0].style.transform = 'none';
                spans[1].style.opacity = '1';
                spans[2].style.transform = 'none';
            }

            window.scrollTo({
                top: targetElement.offsetTop - 80, // CompensaÃ§Ã£o do header fixo
                behavior: 'smooth'
            });
        }
    });
});

// 6. Efeito de Neve Natalina (Melhorada)
function startSnow() {
    // Cria um floco a cada 300ms
    setInterval(() => {
        const snowflake = document.createElement('div');
        snowflake.classList.add('snowflake');
        
        // Emojis variados para o Natal
        const symbols = ['â„', 'â…', 'â†', 'âœ¨']; 
        snowflake.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
        
        snowflake.style.left = Math.random() * 100 + 'vw';
        snowflake.style.opacity = Math.random() * 0.6 + 0.4;
        snowflake.style.fontSize = Math.random() * 15 + 10 + 'px';
        snowflake.style.animationDuration = Math.random() * 5 + 3 + 's';
        
        document.body.appendChild(snowflake);
        
        // Remove depois de cair
        setTimeout(() => {
            snowflake.remove();
        }, 8000);
    }, 300);
}
